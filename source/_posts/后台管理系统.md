---
title: 后台管理系统
date: 2020-07-16 20:22:33
tags: [学习，vue]
categories: vue
---

本篇主要是对进行后台管理系统搭建时，遇到的坑，进行的一些总结。

<!-- more -->

#### 1、使用vuecli3以及elementui进行构建

实现功能：

登录：

主要逻辑：

- 根据用户名以及密码 后台返回用户角色以及token值 
- 在点击登录时先清空之前的路由信息、将角色路由、token存如cookie
- 然后添加返回的角色路由
- 跳转主页面

注意细节：

- 在路由前置：判断用户登录状态 未登录跳转登录页 已登录跳转首页 ==> 防止路由死循环

  ```
  router.beforeEach((to,from,next)=>{
    //从cookie中获取token 防止刷新后token丢失
    store.commit('getToken') 
    //从cookie中获取menu
    store.commit('getMenu') 
    let token = store.state.user.token
    // 过滤登录页，防止死循环
    if(!token && to.name !== 'login'){
      next({name:'login'})
    }else{
      next()  //放行
    }
  })
  ```

  最后要注意添加路由到动态路由中

- 在退出登录时清空token、menu、刷新页面

首页：

主要逻辑：

- 主要实现侧边栏、导航栏、tab栏三级联动
- 在侧边栏点击时将当前点击的route对象存入state中 分别存如current、tabList两者分别控制header、tab
- 在header中显示currentpath、label
- 在tab中对点击的历史记录进行显示 tablist中取出 然后展示 点击x号关闭 点击标签跳转
- 对echarts的封装 具体思路代码中有 

用户

主要逻辑：

- 实现对用户数据的增、删、改、查以及分页器的使用 
- 对form表单的封装

#### 2、 学到的点

- element-ui中message按需引入

  ```
  import {Message，MessageBox} from 'element-ui';
  import 'element-ui/lib/theme-chalk/index.css';
  
  Vue.prototype.$message = Message;
  Vue.prototype.$confirm = MessageBox.confirm;
  ```

- sockjs的报错

  ```
  在使用vue-cli脚手架创建项目的时候，在cnpm create app命令后，项目创建成功后通过npm run serve命令运行以后，控制台报错，sockjs.js?9be2:1606 GET http://192.168.16.105:8080/sockjs-node/info?t=1574662800493 net::ERR_CONNECTION_TIMED_OUT
  
  错误分析：
  sockjs-node是一个JavaScript库，提供跨浏览器JavaScript的API，创建了一个低延迟、全双工的浏览器和web服务器之间通信通道。在项目运行以后，network会一直调用这个接口。如果没有使用，那么就一直会报这个异常。
  
  解决办法：
  1）找到/node_modules/sockjs-client/dist/sockjs.js
  2）在1605行，注释掉self.xhr.send(payload);这一行，然后就可以解决了
  
  try {
     // self.xhr.send(payload);
   } catch (e) {
     self.emit('finish', 0, '');
     self._cleanup(false);
   }
  ```

- vue.config.js的配置

  ```
  module.exports = {
      publicPath: './',  //打包时页面白屏的解决办法
      //devServer相关配置 若存在跨域信息 可在这里使用proxy进行处理
      devServer:{
          port:3333,  //启动的端口号
          open:true,
          proxy:{}
      },
      css: {
          //css预设器配置项
          loaderOptions:{
              sass:{
                  prependData: `@import "@/assets/scss/_variable.scss";`  //这里使用prependData 所有的新版本都改为使用prependData
              }
          }
      }
  }
  ```

- .native .sync

  ```
  .native 当组件没有提供该方法时，可使用.native
  .sync 可以将子组件的改变与父组件同步
  ```

#### 3、项目代码

[源码地址](https://github.com/userSanEr/Background-management-system)





