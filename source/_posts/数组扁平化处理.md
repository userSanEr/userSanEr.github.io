---
title: 数组扁平化处理
date: 2020-07-16 20:16:52
tags: [学习，工具类]
categories: 工具类
---

本篇主要利用数组的多种方法，对数组进行扁平化处理。

<!-- more -->

##### 1、只可以转化二维数组

- es6

  - 使用es6的解构语法，解构数组的每一项逐个插入数组

  ```
  const esArr = [].concat(...arr) 
  ```

- arr.flatMap()

  - 因为.flatMap是先进行map映射之后，再进行flat扁平化处理，因为不能传入扁平化深度，所以只能对一维数组进行扁平化处理

  ```
  const flatMapArr = arr.flatMap(function(item){
  	return item
  })
  ```

- 使用apply、concat方法

  - 如果concat方法的参数是一个元素，该元素会被直接插入到新数组中；如果参数是一个数组，该数组的各个元素将被插入到新数组中；如果直接使用concat进行降维的话，需要循环每一项逐个插入到数组中
  - apply方法会调用一个函数，apply方法的第一个参数会作为被调用函数的this值，apply方法的第二个参数（一个数组，或类数组的对象）会作为被调用对象的arguments值，也就是说该数组的各个元素将会依次成为被调用函数的各个参数
  - 当两者结合之后，apply的第二个参数的值会逐个插入到concat中，解决了concat需要循环逐步插入的问题

  ```
  const applyArr = Array.prototype.concat.apply([],arguments
  ```

##### 2、对多维数组进行处理

- arr.flat()

  - 因为数组的flat方法可以传入你要进行扁平化的深度值，甚至可以直接传入Infinity这个值，进行直接扁平化所有

  ```
  const flatArr = arr.flat(Infinity);
  ```

- arr.reduce()方法

  - 使用reduce可以传入第二个参数为函数进行操作时的pre值，使得第一项为一个空数组
  - 然后再使用reduce累计的特性，返回累计之后的值
  - 在代码里使用三目运算符，先判断要拼接的那一项是否为一个数组，如果是一个数组，那就再次进行判断，它里面的是不是一个数组，如果不是则拼接到原数组中
  - 简化写法：`return arr.reduce((pre,cur)=>pre.concat(Array.isArray(cur)?newArr(cur):cur),[])`

  ```
  const newArr = function(arr){
  	return arr.reduce(function(pre,cur){
  		return pre.concat(Array.isArray(cur)?newArr(cur):cur)
  	},[])
  }
  ```

- 使用map、es6、concat解构

  - 将传入的arguments通过es6语法解构
  - 然后通过map映射每一项，判断是不是一个数组，如果是一个数组再进行解构，如果不是则返回当前参数
  - 然后使用concat进行链接
  - 简单写法`arr => [].concat(...arr.map(v =>{(Array.isArray(v) ? deepFlatten(v) : v)}));`

  ```
  const deepFlatten = function(arr){
      return [].concat(...arr.map(
          function(v){
          	return (Array.isArray(v) ? deepFlatten(v) : v)
      }))
  }
  ```


